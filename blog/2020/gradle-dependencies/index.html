<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Scully 0.0.0">
  <meta charset="utf-8">
  <title>Software Noise</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="icon" type="image/png" href="assets/avatar-480x480.png">
<link rel="stylesheet" href="styles.css"><style></style><script charset="utf-8" src="common-es2015.js"></script><script charset="utf-8" src="2-es2015.js"></script><script charset="utf-8" src="7-es2015.js"></script><style>a[_ngcontent-gme-c9]{text-decoration:none}</style><style>a[_ngcontent-gme-c11]:first-child{padding-left:0}footer[_ngcontent-gme-c11]   a[_ngcontent-gme-c11]{text-decoration:none}</style><style>
      :host {
        display: none;
      }
      scully-content {
        display: none;
      }
    </style><style>a[_ngcontent-gme-c10]:first-child{padding-left:0}a[_ngcontent-gme-c10]:last-child{padding-right:0}a[_ngcontent-gme-c10]{-webkit-text-decoration:underline dotted #a0aec0;text-decoration:underline dotted #a0aec0}</style><script>window['ScullyIO']='generated';</script></head>
<body class="bg-gray-100" scully-version="0.0.0">
  <app-root _nghost-gme-c7="" ng-version="9.1.7"><router-outlet _ngcontent-gme-c7=""></router-outlet><app-blog _nghost-gme-c14=""><app-header _ngcontent-gme-c14="" _nghost-gme-c9=""><header _ngcontent-gme-c9="" class="border-b bg-white"><div _ngcontent-gme-c9="" class="m-0 px-3 max-w-screen-xl mx-auto flex items-center justify-between"><h1 _ngcontent-gme-c9="" class="text-xs uppercase tracking-heavy font-semibold leading-10 pr-3 border-r"><a _ngcontent-gme-c9="" class="flex space-x-1 items-center hover:text-blue-800" href="/"><img _ngcontent-gme-c9="" src="assets/avatar-480x480.png" alt="avatar" class="w-8"><span _ngcontent-gme-c9="">Software&nbsp;Noise</span></a></h1><nav _ngcontent-gme-c9="" class="flex items-center divide-x divide-gray-400"><div _ngcontent-gme-c9="" class="text-xs uppercase tracking-heavy font-light mx-2"><a _ngcontent-gme-c9="" href="https://docs.openapiprocessor.io" class="flex items-center hover:text-blue-800"><img _ngcontent-gme-c9="" src="assets/openapi-processor-p.svg" class="w-12 text-5xl"><span _ngcontent-gme-c9="" class="hidden sm:inline">openapi-processor</span><span _ngcontent-gme-c9="" class="sm:hidden">oap</span></a></div><div _ngcontent-gme-c9="" class="text-xs uppercase tracking-heavy font-light pl-2"><a _ngcontent-gme-c9="" href="https://playground.openapiprocessor.io/" class="flex items-center hover:text-blue-800"><span _ngcontent-gme-c9="" class="hidden sm:inline">playground</span><span _ngcontent-gme-c9="" class="sm:hidden">play</span></a></div></nav></div></header></app-header>

<main _ngcontent-gme-c14="" class="m-0 px-0 lg:px-5 py-5 max-w-screen-xl mx-auto">

  

  <div _ngcontent-gme-c14="" class="lg:flex lg:flex-row-reverse">

    <section _ngcontent-gme-c14="" class="flex-col lg:flex-grow lg:w-main">

      <article _ngcontent-gme-c14="" class="bg-white p-8 border">

        

        <header _ngcontent-gme-c14="" class="pt-2 pb-8 border-b">
          <div _ngcontent-gme-c14="">
            <h1 _ngcontent-gme-c14="" class="text-3xl text-center font-bold mb-4">fixing a (transitive) dependency mess with gradle</h1>
            <p _ngcontent-gme-c14="" class="text-gray-700 text-center mb-6">how to make gradle use the expected versions of transitive dependencies</p>
          </div>

          <div _ngcontent-gme-c14="" class="flex justify-center text-sm text-gray-500 mt-3">
            <app-tag-list _ngcontent-gme-c14="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/gradle"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">gradle</span></a><!----><!----></div></app-tag-list>
          </div>

          <div _ngcontent-gme-c14="" class="text-sm text-gray-500 text-center mt-2">
            <time _ngcontent-gme-c14="" class="font-bold" datetime="2020-06-07T00:00:00.000Z">07. Jun 2020</time>
          </div>
        </header><!---->

        <!---->

        <div _ngcontent-gme-c14="" class="mt-4">
          <app-blog-content _ngcontent-gme-c14="" _nghost-gme-c13=""><div _ngcontent-gme-c13="" class="asciidoctor"><!--scullyContent-begin--><div class="sect1" _ngcontent-gme-c13="">
<h2 id="_the_transitive_dependency_mess" _ngcontent-gme-c13="">the transitive dependency mess</h2>
<div class="sectionbody" _ngcontent-gme-c13="">
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">While extracting openapi-processor-core from <a href="https://hauner.github.io/openapi-processor" target="_blank" rel="noopener" _ngcontent-gme-c13="">openapi-processor-spring</a>
I noticed IDEA listing duplicate dependencies with different and sometimes unexpected versions in
the external libraries section o the project view.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">In this case jackson packages.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Running <code _ngcontent-gme-c13="">gradle dependencies</code> to see where they are coming from prints the following output (
look for <code _ngcontent-gme-c13="">jackson</code>):</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="title" _ngcontent-gme-c13="">gradle dependencies (simplified)</div>
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-text" data-lang="text" _ngcontent-gme-c13="">+--- com.fasterxml.jackson.module:jackson-module-kotlin:2.11.0
|    +--- com.fasterxml.jackson.core:jackson-databind:2.11.0 <b class="conum" _ngcontent-gme-c13="">(1)</b>
|    |    +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0
|    |    \--- com.fasterxml.jackson.core:jackson-core:2.11.0
|    \--- com.fasterxml.jackson.core:jackson-annotations:2.11.0
+--- org.openapi4j:openapi-parser:1.0
|    \--- org.openapi4j:openapi-core:1.0
|         +--- com.fasterxml.jackson.core:jackson-databind:2.9.10 -&gt; 2.11.0 (*) <b class="conum" _ngcontent-gme-c13="">(2)</b>
|         \--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.9.10 -&gt; 2.10.2 <b class="conum" _ngcontent-gme-c13="">(3)</b>
|              \--- com.fasterxml.jackson.core:jackson-core:2.10.2 -&gt; 2.11.0 <b class="conum" _ngcontent-gme-c13="">(4)</b>
+--- io.swagger.parser.v3:swagger-parser:2.0.20
     +--- io.swagger.parser.v3:swagger-parser-v3:2.0.20
          +--- io.swagger.core.v3:swagger-models:2.1.2
          |    \--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0 <b class="conum" _ngcontent-gme-c13="">(5)</b>
          +--- io.swagger.core.v3:swagger-core:2.1.2
          |    +--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0
          |    +--- com.fasterxml.jackson.core:jackson-databind:2.10.1 -&gt; 2.11.0 (*)
          |    +--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.10.1 -&gt; 2.10.2 (*) <b class="conum" _ngcontent-gme-c13="">(6)</b>
          |    +--- com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.10.1 <b class="conum" _ngcontent-gme-c13="">(7)</b>
          |         +--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0
          |         +--- com.fasterxml.jackson.core:jackson-core:2.10.1 -&gt; 2.11.0
          |         \--- com.fasterxml.jackson.core:jackson-databind:2.10.1 -&gt; 2.11.0 (*)
          +--- com.fasterxml.jackson.core:jackson-annotations:2.10.2 -&gt; 2.11.0
          +--- com.fasterxml.jackson.core:jackson-databind:2.10.2 -&gt; 2.11.0 (*)
          \--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.10.2 (*) <b class="conum" _ngcontent-gme-c13="">(8)</b></code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">There is a bit of a mess regarding the jackson packages and their versions. Here are a couple of
entries:</p>
</div>
<div class="colist arabic" _ngcontent-gme-c13="">
<ol _ngcontent-gme-c13="">
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">some with version 2.11.0</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">upgrade from 2.9.10 to 2.11.0</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">upgrade from 2.9.10 to 2.10.2</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">upgrade from 2.10.2 to 2.11.0</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">upgrade from 2.10.1 to 2.11.0</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">upgrade from 2.10.1 to 2.10.2</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">version 2.10.1</p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">version 2.10.2</p>
</li>
</ol>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">The 3 top-level dependencies are direct dependencies (as gradle calls them) of my project and all of
them use different jackson versions:</p>
</div>
<div class="olist arabic" _ngcontent-gme-c13="">
<ol class="arabic" _ngcontent-gme-c13="">
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">com.fasterxml.jackson.module:jackson-module-kotlin:2.11.0</code></p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">org.openapi4j:openapi-parser:1.0</code></p>
</li>
<li _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">io.swagger.parser.v3:swagger-parser:2.0.20</code></p>
</li>
</ol>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">The first one is simple. Because <code _ngcontent-gme-c13="">com.fasterxml.jackson.module:jackson-module-kotlin</code> is a jackson
package itself, gradle selects <strong _ngcontent-gme-c13="">2.11.0</strong> for the other transitive jackson dependencies.</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="title" _ngcontent-gme-c13="">jackson-module-kotlin (simplified)</div>
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-text" data-lang="text" _ngcontent-gme-c13="">+--- com.fasterxml.jackson.module:jackson-module-kotlin:2.11.0
     +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0
     +--- com.fasterxml.jackson.core:jackson-core:2.11.0
     \--- com.fasterxml.jackson.core:jackson-databind:2.11.0</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Next one is <code _ngcontent-gme-c13="">org.openapi4j:openapi-parser:1.0</code>. This one depends on jackson <strong _ngcontent-gme-c13="">2.9.10</strong> and gradle
upgrades everything to <strong _ngcontent-gme-c13="">2.11.0</strong> because that is the newest version it found.</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="title" _ngcontent-gme-c13="">openapi-parser (simplified)</div>
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-text" data-lang="text" _ngcontent-gme-c13="">+--- org.openapi4j:openapi-parser:1.0
     +--- com.fasterxml.jackson.core:jackson-core:2.10.2 -&gt; 2.11.0
     +--- com.fasterxml.jackson.core:jackson-databind:2.9.10 -&gt; 2.11.0 (*)
     \--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.9.10 -&gt; 2.10.2</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Ok, not for all jackson packages. It doesn’t use <strong _ngcontent-gme-c13="">2.11.0</strong> for <code _ngcontent-gme-c13="">jackson-dataformat-yaml</code>.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">It is not using <strong _ngcontent-gme-c13="">2.11.0</strong> because gradle has not seen a newer version of <code _ngcontent-gme-c13="">jackson-dataformat-yaml</code>
than <strong _ngcontent-gme-c13="">2.9.10</strong>. So why is it not <strong _ngcontent-gme-c13="">2.9.10</strong>? It is not because the third direct dependency
<code _ngcontent-gme-c13="">io.swagger.parser.v3:swagger-parser:2.0.20</code> is using <strong _ngcontent-gme-c13="">2.10.1</strong> and <strong _ngcontent-gme-c13="">2.10.2</strong>.</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="title" _ngcontent-gme-c13="">swagger-parser (simplified)</div>
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-text" data-lang="text" _ngcontent-gme-c13="">+--- io.swagger.parser.v3:swagger-parser:2.0.20
     +--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0
     +--- com.fasterxml.jackson.core:jackson-core:2.10.1 -&gt; 2.11.0
     +--- com.fasterxml.jackson.core:jackson-databind:2.10.1 -&gt; 2.11.0
     +--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.10.1 -&gt; 2.10.2
     \--- com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.10.1</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><strong _ngcontent-gme-c13="">2.10.2</strong> for <code _ngcontent-gme-c13="">jackson-dataformat-yaml</code>. This is the highest version for this package so gradle picks
it.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Gradle finally selects the following versions:</p>
</div>
<table class="tableblock frame-all grid-all stretch" _ngcontent-gme-c13="">
<colgroup _ngcontent-gme-c13="">
<col style="width: 50%;" _ngcontent-gme-c13="">
<col style="width: 50%;" _ngcontent-gme-c13="">
</colgroup>
<thead _ngcontent-gme-c13="">
<tr _ngcontent-gme-c13="">
<th class="tableblock halign-left valign-top" _ngcontent-gme-c13="">package (stripped com.fasterxml.jackson.)</th>
<th class="tableblock halign-left valign-top" _ngcontent-gme-c13="">version</th>
</tr>
</thead>
<tbody _ngcontent-gme-c13="">
<tr _ngcontent-gme-c13="">
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">core:jackson-annotations</code></p></td>
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13="">2.11.0</p></td>
</tr>
<tr _ngcontent-gme-c13="">
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">core:jackson-core</code></p></td>
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13="">2.11.0</p></td>
</tr>
<tr _ngcontent-gme-c13="">
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">core:jackson-databind</code></p></td>
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13="">2.11.0</p></td>
</tr>
<tr _ngcontent-gme-c13="">
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">dataformat:jackson-dataformat-yaml</code></p></td>
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13="">2.10.2   ⇒ want 2.11.0</p></td>
</tr>
<tr _ngcontent-gme-c13="">
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13=""><code _ngcontent-gme-c13="">datatype:jackson-datatype-jsr310</code></p></td>
<td class="tableblock halign-left valign-top" _ngcontent-gme-c13=""><p class="tableblock" _ngcontent-gme-c13="">2.10.1 ⇒ want 2.11.0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Gradle uses the highest version it does find for each package. It doesn’t know that the jackson
packages belong together and that all of them should use the same version.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">There are two possible solutions to make all jackson packages use the expected version.</p>
</div>
</div>
</div>
<div class="sect1" _ngcontent-gme-c13="">
<h2 id="_solution" _ngcontent-gme-c13="">solution</h2>
<div class="sectionbody" _ngcontent-gme-c13="">
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">According to the gradle documentation the preferred solution is to add a <code _ngcontent-gme-c13="">constraints</code> block to the
<code _ngcontent-gme-c13="">dependencies</code>. Adding a direct dependency is not the correct solution:</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><a href="https://docs.gradle.org/current/userguide/dependency_constraints.html" target="_blank" rel="noopener" _ngcontent-gme-c13="">gradle constraints</a></p>
</div>
<div class="quoteblock" _ngcontent-gme-c13="">
<blockquote _ngcontent-gme-c13="">
Often developers incorrectly fix transitive dependency issues by adding direct dependencies. To
avoid this, Gradle provides the concept of dependency constraints.
</blockquote>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Modifying the dependency resolution rules is not an option either:</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13=""><a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:dependency_resolve_rules" target="_blank" rel="noopener" _ngcontent-gme-c13="">gradle dependency resolve rules</a></p>
</div>
<div class="quoteblock" _ngcontent-gme-c13="">
<blockquote _ngcontent-gme-c13="">
If you are authoring a library, you should always prefer dependency constraints as they are
published for your consumers.
</blockquote>
</div>
<div class="sect2" _ngcontent-gme-c13="">
<h3 id="_constraints" _ngcontent-gme-c13="">constraints</h3>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">The project is a library and the constraints solution look like this in the <code _ngcontent-gme-c13="">build.gradle</code>:</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-groovy" data-lang="groovy" _ngcontent-gme-c13="">ext {
    jacksonVersion = '2.11.0'
}

dependencies {
    // .. dependencies ..

    constraints {
        implementation("com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:$jacksonVersion") {
            because 'use the same version for all jackson packages'
        }
        implementation("com.fasterxml.jackson.datatype:jackson-datatype-jsr310:$jacksonVersion") {
            because 'use the same version for all jackson packages'
        }
    }

}</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Ok, this fixes the issue. :-)</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Too bad each single package requires its own constraint (the closure with <code _ngcontent-gme-c13="">because</code> ist not required).
It would be nice to use wildcards to match all jackson packages with a single constraint:</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-groovy" data-lang="groovy" _ngcontent-gme-c13="">ext {
    jacksonVersion = '2.11.0'
}

dependencies {
    // .. dependencies ..

    constraints {
        // does NOT work
        implementation("com.fasterxml.jackson.*:*:$jacksonVersion") {
            because 'use the same version for all jackson packages'
        }
    }

}</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">That would be a bit simpler but unfortunately it does not work.</p>
</div>
</div>
<div class="sect2" _ngcontent-gme-c13="">
<h3 id="_platform" _ngcontent-gme-c13="">platform</h3>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">I found another solution in the gradle documentation that even uses jackson as an example:
<a href="https://docs.gradle.org/current/userguide/dependency_version_alignment.html" target="_blank" rel="noopener" _ngcontent-gme-c13="">gradle dependency version alignment</a>.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">First step is to create a metadata rule that joins all jackson packages into a <strong _ngcontent-gme-c13="">platform</strong>. Jackson
has a platform bom that lists all packages belonging to a platform version, and it is used to create
the platform rule:</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-groovy" data-lang="groovy" _ngcontent-gme-c13="">class JacksonPlatformRule implements ComponentMetadataRule {
    void execute (ComponentMetadataContext ctx) {
        ctx.details.with {
            if (id.group.startsWith ("com.fasterxml.jackson")) {
                belongsTo ("com.fasterxml.jackson:jackson-bom:${id.version}", false)
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">I simply added the class at the end of the <code _ngcontent-gme-c13="">build.gradle</code> for testing, but it will probably move to
gradles <code _ngcontent-gme-c13="">buildSrc</code> folder.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">Second step is to activate the rule in the <code _ngcontent-gme-c13="">dependencies</code> block:</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-groovy" data-lang="groovy" _ngcontent-gme-c13="">dependencies {
    components.all(JacksonPlatformRule)

    // .. dependencies ..
}</code></pre>
</div>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">By grouping the packages gradle now selects the jackson <strong _ngcontent-gme-c13="">platform</strong> with the highest version and uses
the versions listed in the bom for any jackson package.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">This is also visible in the output of <code _ngcontent-gme-c13="">gradle dependencies</code> (starting at line 4). Gradle selects
the <strong _ngcontent-gme-c13="">2.11.0</strong> platform module and upgrades all jackson packages to the platform version:</p>
</div>
<div class="listingblock" _ngcontent-gme-c13="">
<div class="title" _ngcontent-gme-c13="">gradle dependencies (simplified)</div>
<div class="content" _ngcontent-gme-c13="">
<pre class="highlight" _ngcontent-gme-c13=""><code class="language-text" data-lang="text" _ngcontent-gme-c13="">+--- com.fasterxml.jackson.module:jackson-module-kotlin:2.11.0
|    +--- com.fasterxml.jackson.core:jackson-databind:2.11.0
|    |    +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0
|    |    |    \--- com.fasterxml.jackson:jackson-bom:2.11.0
|    |    |         +--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
|    |    |         +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0 (c)
|    |    |         +--- com.fasterxml.jackson.core:jackson-core:2.11.0 (c)
|    |    |         +--- com.fasterxml.jackson.core:jackson-databind:2.11.0 (c)
|    |    |         +--- com.fasterxml.jackson.module:jackson-module-kotlin:2.11.0 (c)
|    |    |         +--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.11.0 (c)
|    |    |         \--- com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.11.0 (c)
|    |    +--- com.fasterxml.jackson.core:jackson-core:2.11.0
|    |    |    \--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
|    |    \--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
|    +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0 (*)
|    \--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
+--- org.openapi4j:openapi-parser:1.0
|    \--- org.openapi4j:openapi-core:1.0
|         +--- com.fasterxml.jackson.core:jackson-databind:2.9.10 -&gt; 2.11.0 (*)
|         \--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.9.10 -&gt; 2.11.0
|              +--- com.fasterxml.jackson.core:jackson-databind:2.11.0 (*)
|              +--- org.yaml:snakeyaml:1.26
|              +--- com.fasterxml.jackson.core:jackson-core:2.11.0 (*)
|              \--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
+--- io.swagger.parser.v3:swagger-parser:2.0.20
     +--- io.swagger.parser.v3:swagger-parser-v3:2.0.20
          +--- io.swagger.core.v3:swagger-models:2.1.2
          |    \--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0 (*)
          +--- io.swagger.core.v3:swagger-core:2.1.2
          |    +--- com.fasterxml.jackson.core:jackson-annotations:2.10.1 -&gt; 2.11.0 (*)
          |    +--- com.fasterxml.jackson.core:jackson-databind:2.10.1 -&gt; 2.11.0 (*)
          |    +--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.10.1 -&gt; 2.11.0 (*)
          |    \--- com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.10.1 -&gt; 2.11.0
          |         +--- com.fasterxml.jackson.core:jackson-annotations:2.11.0 (*)
          |         +--- com.fasterxml.jackson.core:jackson-core:2.11.0 (*)
          |         +--- com.fasterxml.jackson.core:jackson-databind:2.11.0 (*)
          |         \--- com.fasterxml.jackson:jackson-bom:2.11.0 (*)
          +--- com.fasterxml.jackson.core:jackson-annotations:2.10.2 -&gt; 2.11.0 (*)
          +--- com.fasterxml.jackson.core:jackson-databind:2.10.2 -&gt; 2.11.0 (*)
          \--- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.10.2 -&gt; 2.11.0 (*)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1" _ngcontent-gme-c13="">
<h2 id="_conclusion" _ngcontent-gme-c13="">conclusion</h2>
<div class="sectionbody" _ngcontent-gme-c13="">
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">The <code _ngcontent-gme-c13="">constraints</code> solution is easy to use on single dependencies. The platform rule is the way to go
for groups of packages like jackson.</p>
</div>
<div class="paragraph" _ngcontent-gme-c13="">
<p _ngcontent-gme-c13="">That’s it. <i class="far fa-smile" _ngcontent-gme-c13=""></i></p>
</div>
</div>
</div><!--scullyContent-end--><script>try {window['scullyContent'] = {cssId:"_ngcontent-gme-c13",html:document.body.innerHTML.split('<!--scullyContent-begin-->')[1].split('<!--scullyContent-end-->')[0]};} catch(e) {console.error('scully could not parse content');}</script><scully-content _ngcontent-gme-c13=""></scully-content></div></app-blog-content>
        </div>
      </article>

    </section>

    <app-sidebar _ngcontent-gme-c14="" _nghost-gme-c11=""><aside _ngcontent-gme-c11="" class="lg:w-sidebar bg-gray-100 p-4 divide-y"><section _ngcontent-gme-c11="" class="flex flex-col mb-8"><a _ngcontent-gme-c11="" class="flex justify-center lg:justify-start" href="/"><img _ngcontent-gme-c11="" src="assets/avatar-480x480.png" alt="avatar" class="w-20"></a><header _ngcontent-gme-c11="" class="text-xs uppercase tracking-heavy font-light mt-4 text-center lg:text-left whitespace-no-wrap"><p _ngcontent-gme-c11="">my Exocortex Memory :-)</p></header></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/openapi-processor-mapping">openapi-processor-spring type mapping</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/openapi"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">openapi</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-08-14T00:00:00.000Z">14. Aug 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/openapi-processor-maven">configuring openapi-processor-maven</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/openapi"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">openapi</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/maven"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">maven</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/spring-boot"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">spring-boot</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-07-18T00:00:00.000Z">18. Jul 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/gradle-publishing">publishing to bintray &amp; oss.jfrog.org with gradle &amp; maven-publish</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/gradle"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">gradle</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/bintray"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">bintray</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-06-24T00:00:00.000Z">24. Jun 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/remember/bintray-getting-started">bintray - getting started</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/bintray"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">bintray</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/jcenter"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">jcenter</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-06-24T00:00:00.000Z">24. Jun 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/gradle-dependencies">fixing a (transitive) dependency mess with gradle</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/gradle"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">gradle</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-06-07T00:00:00.000Z">07. Jun 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/remember/git-branch-to-own-repo">create new git repository from a branch</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/git"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">git</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-06-02T00:00:00.000Z">02. Jun 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/openapi-processor-spring">openapi-processor-spring</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/openapi"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">openapi</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/spring-boot"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">spring-boot</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-05-25T00:00:00.000Z">25. May 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/remember/java-macos">java on macos</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/java"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">java</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/macos"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">macos</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-05-24T00:00:00.000Z">24. May 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/rxjs-custom-operator">Extracting a custom RxJS operator</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/rxjs"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">rxjs</span></a><!----><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/angular"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">angular</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-05-12T00:00:00.000Z">12. May 2020</time></div></article></section><section _ngcontent-gme-c11="" class="py-4"><article _ngcontent-gme-c11=""><header _ngcontent-gme-c11="" class="text-center lg:text-left"><a _ngcontent-gme-c11="" class="font-light text-sm" href="/blog/2020/angular-body-class">Modifying &lt;body&gt; css classes in Angular</a></header><div _ngcontent-gme-c11="" class="text-xs text-gray-500 mt-2"><app-tag-list _ngcontent-gme-c11="" _nghost-gme-c10=""><div _ngcontent-gme-c10="" class="flex flex-wrap justify-center lg:justify-start divide-x uppercase tracking-widest"><a _ngcontent-gme-c10="" class="flex items-center px-2 underline hover:text-blue-800" href="/tags/angular"><i _ngcontent-gme-c10="" class="fas fa-tag"></i><span _ngcontent-gme-c10="" class="pl-1">angular</span></a><!----><!----></div></app-tag-list></div><div _ngcontent-gme-c11="" class="text-center lg:text-left"><time _ngcontent-gme-c11="" class="text-xs text-gray-500" datetime="2020-05-05T00:00:00.000Z">05. May 2020</time></div></article></section><!----><!----><!----><section _ngcontent-gme-c11=""><footer _ngcontent-gme-c11="" class="flex flex-col uppercase tracking-heavy text-gray-500"><div _ngcontent-gme-c11="" class="flex justify-center lg:justify-start space-x-4 uppercase tracking-heavy text-gray-500 my-8"><a _ngcontent-gme-c11="" href="https://twitter.com/MartinHauner" class="flex items-center hover:text-blue-800"><i _ngcontent-gme-c11="" class="fab fa-twitter"></i></a><a _ngcontent-gme-c11="" href="https://github.com/hauner" class="flex items-center hover:text-blue-800"><i _ngcontent-gme-c11="" class="fab fa-github"></i></a></div><div _ngcontent-gme-c11="" class="text-center lg:text-left" style="font-size: 0.5rem;">© Martin Hauner</div><div _ngcontent-gme-c11="" class="text-center lg:text-left" style="font-size: 0.5rem;"> built with <a _ngcontent-gme-c11="" href="https://github.com/scullyio/scully" class="underline hover:text-blue-800">Scully</a> &amp; <a _ngcontent-gme-c11="" href="https://tailwindcss.com" class="underline hover:text-blue-800">tailwindcss</a></div></footer></section></aside></app-sidebar>

  </div>

  

</main>
</app-blog><!----></app-root>
<script id="ScullyIO-transfer-state"></script><script src="runtime-es2015.js" type="module"></script><script src="runtime-es5.js" nomodule="" defer=""></script><script src="polyfills-es5.js" nomodule="" defer=""></script><script src="polyfills-es2015.js" type="module"></script><script src="main-es2015.js" type="module"></script><script src="main-es5.js" nomodule="" defer=""></script>

</body></html>